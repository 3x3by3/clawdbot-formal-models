SPECIFICATION Spec
INVARIANT Inv_NoSensitiveExecInShared

CONSTANTS
  Tools = {"memory_get", "memory_search", "nodes.run", "message.send"}
  SensitiveTools = {"memory_get", "memory_search", "nodes.run"}

  \* shared allowlist excludes sensitive tools
  PolicyAllowShared = {"message.send"}
  PolicyAllowMain = {"memory_get", "memory_search", "nodes.run", "message.send"}

  \* nodes.run is additionally gated by node command policy
  NodesRunTool = "nodes.run"
  NodeCommandAllowlisted = TRUE
  NodeCommandDeclared = TRUE

  MaxQueueLen = 3
  MaxExecLen = 3
